language: groovy
jdk:
  - oraclejdk8
os:
  - linux
before_cache: 
  - echo "################################################## START CACHE"
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
after_cache:
  - echo "################################################## FINISH CACHE"
script:
  - gradle clean build
  - export RELEASE_PKG_FILE=$(ls build/distributions/*.zip)
  - echo "# Zip File => $RELEASE_PKG_FILE"

before_deploy:
  - export RELEASE_PKG_FILE=$(ls build/distributions/*.zip)
  - echo "################################################## START DEPLOY "
  - echo "# Deploying $RELEASE_PKG_FILE to GitHsub releases"

deploy:
  provider: releases
  api_key:
    secure: byn8+MSCgtBfYaGHaQQah0b+b17Uf68F4IgJvXkTdfNb93bkCU12wrw6R8CaWAsqi+BizGr43IHY+JPbxOak3OnLnZsctYsosG6aMsl8m53/JkNvQ3ekxcWetBufAzH6nM3ded64Uksdx2LVbzcUNnJ54x9xAntL0NcJwDlW3vB7xKQK34Hs0bkRRMIBCk38wkFWyFyfaNebxL0NzASZksG30jUDetgVSiEU+WJvM2wUrRrl/1UdQH/2ff9ZkgZY7TNGPuMLZj9Yl1L9zkO+1W0IipL3bkHhUYxF9xcbzy8bvfllIauVbHUlWZjwOBp/FBwgp9eeafPP4agqWl1KkEgXaPQE4eJXj0HY4wQsiur7KC661iYZGrsygwFAvtNoAFOM8kwG0hJlw/5OnqGmRTCn3jf1m85Tv/tUAvt3QnaNw1urnm8uY8WnGvzsVUwbNmcTO5iWDWAMWCCyJH0cwqaBO1wWIS+/Mf0JDnnT1LhJ99ntdJXC/BVGfLUmsjFXoHugl4zhKstgjcsXwq9EEtRnwGrT9oEHCt6fmSMVbe/WO0FreOWQdkjiWt59NHqX/9DbqKMq8d2BfcZQ58sGHIYNEST2+ez3SqgXv+bG+8gO/eJrxTABkMVNPTG8ZdD+529qNVhWdm7TliWWLi5KByn/BQCbdnP7OjGWp/Meq6A=
  file: "build/distributions/*.zip"
  file_glob: true
  skip_cleanup: true
  on:
    tags: true
    repo: avaj-java/installer-maker
    all_branches: true

after_deploy:
  - echo "################################################## FINISH DEPLOY"
  
